<div class="d-flex flex-column flex-shrink-0 p-3"
    style="width: 280px; height: calc(100vh - 64px); position: fixed; left: 0; top: 64px; z-index: 1000; background: var(--glass-bg); backdrop-filter: blur(12px); border-right: 1px solid var(--glass-border);">

    <!-- Context: Admin -->
    {% if user and user.is_admin and context == 'admin' %}
    <ul class="nav nav-pills flex-column mb-auto pt-3">
        <li class="nav-item">
            <a href="/admin" class="nav-link text-white {% if active_page == 'admin_dashboard' %}active{% endif %}">
                <i class="bi bi-speedometer2 me-2"></i> {{ t.nav_dashboard }}
            </a>
        </li>
        <li>
            <a href="/admin/models" class="nav-link text-white {% if active_page == 'admin_models' %}active{% endif %}">
                <i class="bi bi-box-seam me-2"></i> {{ t.nav_models }}
            </a>
        </li>
        <li>
            <a href="/admin/providers"
                class="nav-link text-white {% if active_page == 'admin_providers' %}active{% endif %}">
                <i class="bi bi-server me-2"></i> {{ t.nav_providers }}
            </a>
        </li>
        <li>
            <a href="/admin/users" class="nav-link text-white {% if active_page == 'admin_users' %}active{% endif %}">
                <i class="bi bi-people me-2"></i> {{ t.nav_users }}
            </a>
        </li>
    </ul>

    <!-- Context: Finance/Account -->
    {% elif context == 'billing' or context == 'account' %}
    <div class="mb-4 pt-3">
        <div class="card bg-secondary text-white border-0 mb-3 glass-panel">
            <div class="card-body p-3">
                <small class="text-white-50">{{ t.nav_curr_balance }}</small>
                <h3 class="fw-bold mb-0">
                    <span id="sidebar-balance" hx-get="/balance/partial" hx-trigger="load, balanceChanged from:body">
                        {{ balance if balance is defined else '...' }}
                    </span>
                    <span class="fs-6 text-white-50">Cr</span>
                </h3>
            </div>
        </div>
        <a href="/billing" class="btn btn-primary w-100 mb-2">
            <i class="bi bi-plus-circle me-2"></i> {{ t.nav_topup }}
        </a>
    </div>
    <ul class="nav nav-pills flex-column mb-auto">
        <li>
            <a href="/account" class="nav-link text-white {% if active_page == 'account' %}active{% endif %}">
                <i class="bi bi-person-circle me-2"></i> {{ t.nav_profile }}
            </a>
        </li>
        <li>
            <a href="/billing" class="nav-link text-white {% if active_page == 'billing' %}active{% endif %}">
                <i class="bi bi-wallet2 me-2"></i> {{ t.nav_billing }}
            </a>
        </li>
    </ul>

    <!-- Context: Default (Workbench/Home) -->
    {% else %}
    <ul class="nav nav-pills flex-column mb-auto pt-3">
        <li class="nav-item mb-2">
            <a href="/" class="nav-link text-white {% if active_page == 'home' %}active{% endif %}">
                <i class="bi bi-magic me-2"></i> {{ t.nav_workshop }}
            </a>
        </li>
        <li>
            <a href="/#gallery-anchor" class="nav-link text-white d-flex justify-content-between align-items-center">
                <span><i class="bi bi-images me-2"></i> {{ t.nav_generations }}</span>
                <span id="my-session-counter" class="badge bg-primary rounded-pill">0</span>
            </a>
        </li>
        {% if user and user.is_admin %}
        <li>
            <a href="/admin" class="nav-link text-warning mt-3">
                <i class="bi bi-shield-lock me-2"></i> {{ t.adm_dash_title }}
            </a>
        </li>
        {% endif %}
    </ul>
    {% endif %}

</div>